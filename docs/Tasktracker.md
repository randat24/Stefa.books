# Stefa.Books — Task Tracker

Приоритеты: **CRITICAL** / **HIGH** / **MEDIUM** / **LOW**  
Статусы: `[ ]` TODO · `[~]` IN-PROGRESS · `[x]` DONE

## Спринт 0: Бренд + базовая площадка (1–2 дня)

### Цели
- Уникальный визуальный стиль (без эмодзи), подключение логотипа/иконок, стабильный деплой

### Задачи
- `[ ]` **(CRITICAL)** Заменить логотипы и фавиконы, добавить PWA-иконки (`public/brand/*`, `app/icon.png`, `public/favicon.ico`)
- `[ ]` **(HIGH)** Обновить `Header`/`Footer` под новый логотип
- `[ ]` **(HIGH)** Базовые токены в `globals.css` (цвета, типографика, размеры сетки)
- `[ ]` **(HIGH)** Стартовые страницы `/` и `/catalog` (каркас, заглушки компонентов)
- `[ ]` **(HIGH)** Проверить сборку/деплой на Vercel, настроить ENV

### DoD (Definition of Done)
- CI: `pnpm type-check`, `pnpm lint` — без ошибок
- Production-превью с новым брендом

---

## Спринт 1: Каталог + Quick View + подписка (5–7 дней)

### Цели
- Чистая сетка каталога, карточки книг, быстрый просмотр, заявка на подписку в Supabase

### Задачи
- `[ ]` **(CRITICAL)** Грид: xl=5, lg=4, md=2, sm=1 (адаптив)
- `[ ]` **(CRITICAL)** `BookCard`: обложка, название, автор, статус
- `[ ]` **(CRITICAL)** `BookPreviewModal` (Radix UI + Framer Motion) + фикс оверлея `fixed inset-0`
- `[ ]` **(CRITICAL)** `RentalForm`: имя, телефон, план, доставка; валидация
- `[ ]` **(CRITICAL)** Серверный handler (App Router `/api`) → вставка в `subscription_requests`
- `[ ]` **(HIGH)** Skeleton-загрузки, `next/image` + lazy
- `[ ]` **(MEDIUM)** Базовая аналитика: «открыт QuickView», «отправлена подписка»

### DoD
- Клик по карточке → модалка QuickView
- Заявка уходит в БД, валидация отрабатывает

---

## Спринт 2: Поиск/фильтры/SEO (5–7 дней)

### Цели
- Сделать каталог удобным для навигации и улучшить видимость сайта

### Задачи
- `[ ]` **(HIGH)** Поиск по названию/автору (клиентский минимум)
- `[ ]` **(HIGH)** Фильтры/счётчики по категориям (если доступны из БД)
- `[ ]` **(MEDIUM)** Пагинация или «показать ещё»
- `[ ]` **(HIGH)** Мета-данные Next 15: `metadata`, `sitemap`, `robots`
- `[ ]` **(HIGH)** Lighthouse ≥ 90 для главных страниц

### DoD
- Каталог масштабируется до 100+ книг без проседания UX
- SEO-базис на месте; теги корректно формируются

---

## Спринт 3: Auth + Кабинет (7–10 дней)

### Цели
- Подготовить основу для персонализации и будущих функций аренды

### Задачи
- `[ ]` **(HIGH)** Supabase Auth (email-link/OTP)
- `[ ]` **(HIGH)** Мини-кабинет: данные профиля, статус подписки (read-only)
- `[ ]` **(HIGH)** Логика отображения CTA в QuickView: «Оформить подписку» vs «Взять в аренду»
- `[ ]` **(HIGH)** Аудит RLS (deny-by-default), проверка политик

### DoD
- Пользователь может войти и увидеть свой статус
- RLS-политики не допускают утечки данных

---

## Спринт 4: Интеграции/уведомления (5–7 дней)

### Цели
- Подготовить мост к Telegram-боту/mini-app и уведомлениям

### Задачи
- `[ ]` **(MEDIUM)** Веб-входы для бота: проверка подписки, получение списка книг
- `[ ]` **(MEDIUM)** Старт нотификаций (e-mail/webhook) для заявок на подписку
- `[ ]` **(MEDIUM)** Базовые аналитические события (отправка формы, открытие QuickView)

### DoD
- Минимальный обмен данными сайт ↔ бот работает
- События фиксируются в аналитике

---

## Общие критерии готовности (DoD)

### Код
- Проходит `pnpm type-check` и `pnpm lint`
- Нет регрессий на основных разрешениях: мобильный, планшет, десктоп
- Lighthouse ≥ 90 по Performance/Accessibility/SEO на целевых страницах

### Документация
- Обновлены соответствующие разделы в `Project.md` и `Diary.md`

---

## Журнал выполнения

### 2025-01-27
- `[x]` Созданы `docs/*`, добавлены спринты и правила
- `[x]` Проанализирована существующая структура проекта
- `[x]` Создана базовая документация

### 2025-01-28
- `[~]` Анализ существующих компонентов и API
- `[ ]` Планирование интеграции с Supabase

---

## Блокеры и риски

### Спринт 0
- **Риск**: Задержка с финальными цветами/вариантами логотипа
- **Митигация**: Использовать временные ассеты, обновить позже

### Спринт 1
- **Риск**: Неполные данные по книгам
- **Митигация**: Временно допускается mock, постепенная миграция

### Спринт 2
- **Риск**: Изменения схемы БД категорий/книг
- **Митигация**: Гибкая архитектура, версионирование API

### Спринт 3
- **Риск**: Сценарии восстановления доступа и подтверждения email
- **Митигация**: Тщательное тестирование, fallback механизмы

### Спринт 4
- **Риск**: Синхронизация схемы данных и авторизации между сайт/ботом
- **Митигация**: Единая база данных, API-first подход

---

## Метрики успеха

### Технические
- Время загрузки страниц < 2с
- Lighthouse score ≥ 90
- Покрытие тестами ≥ 80%
- Zero критических багов в production

### Бизнес
- Конверсия подписок > 5%
- Время до оформления заявки < 3 минуты
- Отказы от загрузки страниц < 2%

### UX
- Удовлетворенность пользователей > 4.5/5
- Время на поиск книги < 30 секунд
- Успешное завершение форм > 95%
