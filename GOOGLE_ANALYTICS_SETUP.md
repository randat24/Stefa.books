# üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Analytics –¥–ª—è Stefa.Books

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local`

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```bash
# Google Analytics
NEXT_PUBLIC_GA_ID=G-0GRMFJQS12

# –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à–∏ –∫–ª—é—á–∏)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret
NEXT_PUBLIC_SITE_URL=http://stefa-books.com.ua
NEXT_PUBLIC_BASE_URL=http://localhost:3000
NODE_ENV=development
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (Vercel)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings ‚Üí Environment Variables**
2. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `NEXT_PUBLIC_GA_ID` –¥–ª—è Production —Å—Ä–µ–¥—ã
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `G-0GRMFJQS12`

## üîß –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `GoogleAnalytics` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- `CookieConsent` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ cookies
- `useAnalytics` - —Ö—É–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π

### ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–Ω–∏–≥ (`book_view`)
- –ê—Ä–µ–Ω–¥–∞ –∫–Ω–∏–≥ (`book_rental`)
- –ü–æ–¥–ø–∏—Å–∫–∏ (`subscription`)
- –ü–æ–∏—Å–∫ (`search`)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (`sign_up`)
- –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É (`login`)

### ‚úÖ GDPR —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
- –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ cookies
- –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è IP
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## üìà –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { useAnalytics } from '@/hooks/useAnalytics'

export default function MyComponent() {
  const { trackEvent, trackBookView } = useAnalytics()

  const handleClick = () => {
    trackEvent('button_click', 'engagement', 'header_cta')
  }

  const handleBookView = (bookTitle: string, bookId: string) => {
    trackBookView(bookTitle, bookId)
  }

  return (
    <button onClick={handleClick}>
      –ù–∞–∂–º–∏ –º–µ–Ω—è
    </button>
  )
}
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã

```typescript
const {
  trackEvent,           // –û–±—â–µ–µ —Å–æ–±—ã—Ç–∏–µ
  trackPageView,        // –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  trackBookView,        // –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–Ω–∏–≥–∏
  trackBookRental,      // –ê—Ä–µ–Ω–¥–∞ –∫–Ω–∏–≥–∏
  trackSubscription,    // –ü–æ–¥–ø–∏—Å–∫–∞
  trackSearch,          // –ü–æ–∏—Å–∫
  trackUserRegistration, // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  trackUserLogin        // –í—Ö–æ–¥
} = useAnalytics()
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
pnpm dev

# –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
open http://localhost:3000
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Developer Tools ‚Üí Network**
2. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `googletagmanager.com`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Google Analytics –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Google Analytics

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Realtime ‚Üí Overview**
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–∞–π—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–±—ã—Ç–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
echo $NEXT_PUBLIC_GA_ID

# –ò–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
console.log(process.env.NEXT_PUBLIC_GA_ID)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

```javascript
// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ gtag –∑–∞–≥—Ä—É–∂–µ–Ω
console.log(typeof window.gtag)

// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ dataLayer
console.log(window.dataLayer)
```

## üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–ª–µ–π –≤ Google Analytics

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–π

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Admin ‚Üí Goals**
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–µ —Ü–µ–ª–∏:
   - **–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–Ω–∏–≥–∏** (Event: `book_view`)
   - **–ê—Ä–µ–Ω–¥–∞ –∫–Ω–∏–≥–∏** (Event: `book_rental`)
   - **–ü–æ–¥–ø–∏—Å–∫–∞** (Event: `subscription`)
   - **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** (Event: `sign_up`)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

1. **–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞** ‚Üí **–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–Ω–∏–≥–∏** ‚Üí **–ê—Ä–µ–Ω–¥–∞/–ü–æ–¥–ø–∏—Å–∫–∞**
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏

- ‚úÖ IP –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞
- ‚úÖ –†–µ–∫–ª–∞–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
- ‚úÖ –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ cookies
- ‚úÖ GDPR —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```typescript
// –í GoogleAnalytics.tsx —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
gtag('config', 'GA_ID', {
  anonymize_ip: true,
  allow_google_signals: true,
  allow_ad_personalization_signals: false
})
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Google Analytics –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `NEXT_PUBLIC_GA_ID` –≤ `.env.local`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏

### –°–æ–±—ã—Ç–∏—è –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª cookies
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `useAnalytics` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `window.gtag` –¥–æ—Å—Ç—É–ø–µ–Ω

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ Vercel
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
3. –î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç)

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Google Analytics 4 Documentation](https://developers.google.com/analytics/devguides/collection/ga4)
- [Next.js Script Component](https://nextjs.org/docs/basic-features/script)
- [GDPR Compliance Guide](https://support.google.com/analytics/answer/9019185)

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ Google Analytics –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –î–µ–∫–∞–±—Ä—å 2024*
