-- ============================================================================
-- ПОЛНОЕ ОБНОВЛЕНИЕ ВСЕХ 105 КНИГ С ПРАВИЛЬНЫМИ НАЗВАНИЯМИ
-- ============================================================================

-- Создаем временную таблицу с правильными данными для всех 105 книг
CREATE TEMP TABLE correct_books_data (
    code TEXT,
    title TEXT,
    author TEXT,
    description TEXT,
    category TEXT
);

-- Заполняем данными для всех 105 книг
INSERT INTO correct_books_data (code, title, author, description, category) VALUES
-- Книги 1-20 (Классическая литература)
('SB-2025-0001', 'Пригоди Тома Сойєра', 'Марк Твен', 'Класичний роман про пригоди хлопчика Тома Сойєра в містечку Сент-Пітерсберг', 'Пригоди, молодший вік'),
('SB-2025-0002', 'Аліса в Країні Чудес', 'Льюїс Керролл', 'Казкова історія про дівчинку Алісу, яка потрапила в чарівну країну', 'Казки, дошкільний вік'),
('SB-2025-0003', 'Гаррі Поттер і філософський камінь', 'Джоан Роулінг', 'Перша книга про пригоди юного чарівника Гаррі Поттера в школі чарівництва Хогвартс', 'Фентезі, підлітковий вік'),
('SB-2025-0004', 'Шерлок Холмс. Етюд у багряних тонах', 'Артур Конан Дойл', 'Перша детективна повість про знаменитого детектива Шерлока Холмса', 'Детектив, середній вік'),
('SB-2025-0005', 'Маленький принц', 'Антуан де Сент-Екзюпері', 'Філософська казка про маленького принца з далекої планети', 'Казки, дошкільний вік'),
('SB-2025-0006', 'Відьмак. Останнє бажання', 'Анджей Сапковський', 'Фентезійний роман про мисливця на монстрів Геральта з Рівії', 'Фентезі, підлітковий вік'),
('SB-2025-0007', 'Психологія успіху', 'Дейл Карнегі', 'Класична книга про психологію спілкування та досягнення успіху', 'Психологія і саморозвиток'),
('SB-2025-0008', 'Програмування для початківців', 'Марк Лутц', 'Практичний посібник з вивчення програмування на Python', 'Пізнавальні, середній вік'),
('SB-2025-0009', 'Сучасна українська проза', 'Оксана Забужко', 'Збірка сучасних українських оповідань та повістей', 'Сучасна проза'),
('SB-2025-0010', 'Вбивство в "Східному експресі"', 'Агата Крісті', 'Захоплюючий детектив про розслідування злочину в поїзді', 'Детектив, середній вік'),

-- Книги 11-30 (Украинская и русская классика)
('SB-2025-0011', 'Кобзар', 'Тарас Шевченко', 'Збірка поезій великого українського поета', 'Поезія, середній вік'),
('SB-2025-0012', 'Зачарована Десна', 'Олександр Довженко', 'Автобіографічна повість про дитинство', 'Сучасна проза'),
('SB-2025-0013', 'Тіні забутих предків', 'Михайло Коцюбинський', 'Повість про гуцульське життя', 'Класична проза'),
('SB-2025-0014', 'Лісова пісня', 'Леся Українка', 'Драматична поема про кохання', 'Поезія, середній вік'),
('SB-2025-0015', 'Майстер і Маргарита', 'Михайло Булгаков', 'Фантастичний роман про діаволів та кохання', 'Фентезі, підлітковий вік'),
('SB-2025-0016', 'Війна і мир', 'Лев Толстой', 'Епічний роман про російське суспільство під час наполеонівських війн', 'Класична проза'),
('SB-2025-0017', 'Анна Кареніна', 'Лев Толстой', 'Роман про трагічну любов Анни Кареніної', 'Класична проза'),
('SB-2025-0018', 'Преступление и наказание', 'Федір Достоєвський', 'Психологічний роман про моральні муки вбивці', 'Класична проза'),
('SB-2025-0019', 'Ідіот', 'Федір Достоєвський', 'Роман про князя Мишкіна, якого називають ідіотом', 'Класична проза'),
('SB-2025-0020', 'Брати Карамазови', 'Федір Достоєвський', 'Філософський роман про сімейні стосунки та релігійні питання', 'Класична проза'),
('SB-2025-0021', 'Евгеній Онєгін', 'Олександр Пушкін', 'Роман у віршах про кохання та суспільство', 'Класична проза'),
('SB-2025-0022', 'Капітанська дочка', 'Олександр Пушкін', 'Історичний роман про повстання Пугачова', 'Класична проза'),
('SB-2025-0023', 'Дубровський', 'Олександр Пушкін', 'Роман про поміщика Дубровського', 'Класична проза'),
('SB-2025-0024', 'Мертві душі', 'Микола Гоголь', 'Сатиричний роман про російське суспільство', 'Класична проза'),
('SB-2025-0025', 'Тарас Бульба', 'Микола Гоголь', 'Повість про козацького полковника Тараса Бульбу', 'Класична проза'),
('SB-2025-0026', 'Ревізор', 'Микола Гоголь', 'Комедія про міське самоврядування', 'Класична проза'),
('SB-2025-0027', 'Казки братів Грімм', 'Брати Грімм', 'Збірка класичних німецьких казок', 'Казки, дошкільний вік'),
('SB-2025-0028', 'Казки Андерсена', 'Ганс Крістіан Андерсен', 'Чарівні казки датського письменника', 'Казки, дошкільний вік'),
('SB-2025-0029', 'Вінні-Пух', 'Алан Мілн', 'Казка про ведмедика Вінні-Пуха', 'Казки, дошкільний вік'),
('SB-2025-0030', 'Карлсон, який живе на даху', 'Астрід Ліндгрен', 'Казка про чоловічка з пропелером', 'Казки, дошкільний вік'),

-- Книги 31-50 (Фэнтези и приключения)
('SB-2025-0031', 'Володар перснів', 'Джон Рональд Руел Толкін', 'Епічне фентезі про пригоди хоббіта Фродо', 'Фентезі, підлітковий вік'),
('SB-2025-0032', 'Хроніки Нарнії', 'Клайв Стейплз Льюїс', 'Фентезійна серія про пригоди в чарівній країні Нарнія', 'Фентезі, підлітковий вік'),
('SB-2025-0033', 'Гра престолів', 'Джордж Мартін', 'Епічне фентезі про боротьбу за владу', 'Фентезі, підлітковий вік'),
('SB-2025-0034', 'Відьмак. Кров ельфів', 'Анджей Сапковський', 'Продовження пригод Геральта з Рівії', 'Фентезі, підлітковий вік'),
('SB-2025-0035', 'Пригоди Гекльберрі Фінна', 'Марк Твен', 'Пригодницький роман про подорожі хлопчика Гека по Міссісіпі', 'Пригоди, молодший вік'),
('SB-2025-0036', 'Острів скарбів', 'Роберт Луїс Стівенсон', 'Пригодницький роман про піратів', 'Пригоди, молодший вік'),
('SB-2025-0037', 'Робінзон Крузо', 'Даніель Дефо', 'Роман про виживання на необитаємому острові', 'Пригоди, молодший вік'),
('SB-2025-0038', 'Двадцять тисяч льє під водою', 'Жуль Верн', 'Науково-фантастичний роман про підводні пригоди', 'Пригоди, молодший вік'),
('SB-2025-0039', 'Навколо світу за вісімдесят днів', 'Жуль Верн', 'Пригодницький роман про подорож навколо світу', 'Пригоди, молодший вік'),
('SB-2025-0040', 'Таємничий острів', 'Жуль Верн', 'Роман про виживання на острові', 'Пригоди, молодший вік'),
('SB-2025-0041', 'Вбивство в "Східному експресі"', 'Агата Крісті', 'Детектив про розслідування вбивства в поїзді', 'Детектив, середній вік'),
('SB-2025-0042', 'Десять негренят', 'Агата Крісті', 'Детектив про серійного вбивцю на острові', 'Детектив, середній вік'),
('SB-2025-0043', 'Собака Баскервілів', 'Артур Конан Дойл', 'Детектив про загадкову смерть', 'Детектив, середній вік'),
('SB-2025-0044', 'Співаючі в терні', 'Колін Маккалоу', 'Роман про кохання в Австралії', 'Сучасна проза'),
('SB-2025-0045', '1984', 'Джордж Орвелл', 'Антиутопічний роман про тоталітарне суспільство', 'Наукова фантастика'),
('SB-2025-0046', 'Ферма тварин', 'Джордж Орвелл', 'Алегорічний роман про революцію', 'Наукова фантастика'),
('SB-2025-0047', 'Дюна', 'Френк Герберт', 'Епічний науково-фантастичний роман', 'Наукова фантастика'),
('SB-2025-0048', 'Фундамент', 'Айзек Азімов', 'Класика наукової фантастики', 'Наукова фантастика'),
('SB-2025-0049', 'Як завоювати друзів і впливати на людей', 'Дейл Карнегі', 'Класика психології спілкування', 'Психологія і саморозвиток'),
('SB-2025-0050', '7 звичок високоефективних людей', 'Стівен Кові', 'Книга про особистий розвиток', 'Психологія і саморозвиток'),

-- Книги 51-70 (Психология, наука, современная проза)
('SB-2025-0051', 'Мислення швидко і повільно', 'Даніель Канеман', 'Книга про психологію прийняття рішень', 'Психологія і саморозвиток'),
('SB-2025-0052', 'Атомні звички', 'Джеймс Клір', 'Книга про формування корисних звичок', 'Психологія і саморозвиток'),
('SB-2025-0053', 'Коротка історія часу', 'Стівен Гокінг', 'Популярна наука про Всесвіт', 'Пізнавальні, середній вік'),
('SB-2025-0054', 'Сапієнс', 'Юваль Ноа Харарі', 'Історія людства', 'Пізнавальні, середній вік'),
('SB-2025-0055', 'Космос', 'Карл Саган', 'Книга про Всесвіт та космос', 'Пізнавальні, середній вік'),
('SB-2025-0056', 'Геній', 'Вальтер Айзексон', 'Біографія Альберта Ейнштейна', 'Пізнавальні, середній вік'),
('SB-2025-0057', 'Світло, якого не бачимо', 'Ентоні Дорр', 'Роман про Другу світову війну', 'Сучасна проза'),
('SB-2025-0058', 'Маленьке життя', 'Ханья Янагіхара', 'Роман про дружбу та страждання', 'Сучасна проза'),
('SB-2025-0059', 'Нормальні люди', 'Саллі Руні', 'Роман про кохання та відносини', 'Сучасна проза'),
('SB-2025-0060', 'Книжковий злодій', 'Маркус Зусак', 'Роман про дівчинку в нацистській Німеччині', 'Сучасна проза'),
('SB-2025-0061', 'Збірка віршів', 'Олександр Блок', 'Класична російська поезія', 'Поезія, середній вік'),
('SB-2025-0062', 'Збірка віршів', 'Анна Ахматова', 'Поезія Серебряного віку', 'Поезія, середній вік'),
('SB-2025-0063', 'Збірка віршів', 'Марина Цвєтаєва', 'Поезія про кохання та життя', 'Поезія, середній вік'),
('SB-2025-0064', 'Збірка віршів', 'Борис Пастернак', 'Нобелівський лауреат з літератури', 'Поезія, середній вік'),
('SB-2025-0065', 'Гаррі Поттер і таємна кімната', 'Джоан Роулінг', 'Друга книга про пригоди Гаррі Поттера', 'Фентезі, підлітковий вік'),
('SB-2025-0066', 'Гаррі Поттер і в''язень Азкабану', 'Джоан Роулінг', 'Третя книга про пригоди Гаррі Поттера', 'Фентезі, підлітковий вік'),
('SB-2025-0067', 'Гаррі Поттер і келих вогню', 'Джоан Роулінг', 'Четверта книга про пригоди Гаррі Поттера', 'Фентезі, підлітковий вік'),
('SB-2025-0068', 'Гаррі Поттер і Орден Фенікса', 'Джоан Роулінг', 'П''ята книга про пригоди Гаррі Поттера', 'Фентезі, підлітковий вік'),
('SB-2025-0069', 'Гаррі Поттер і напівкровний принц', 'Джоан Роулінг', 'Шоста книга про пригоди Гаррі Поттера', 'Фентезі, підлітковий вік'),
('SB-2025-0070', 'Гаррі Поттер і смертельні реліквії', 'Джоан Роулінг', 'Сьома книга про пригоди Гаррі Поттера', 'Фентезі, підлітковий вік'),

-- Книги 71-90 (Дополнительные классики и современники)
('SB-2025-0071', 'Три мушкетери', 'Александр Дюма', 'Пригодницький роман про мушкетерів', 'Пригоди, молодший вік'),
('SB-2025-0072', 'Граф Монте-Крісто', 'Александр Дюма', 'Роман про помсту та справедливість', 'Пригоди, молодший вік'),
('SB-2025-0073', 'Джейн Ейр', 'Шарлотта Бронте', 'Роман про кохання та незалежність', 'Класична проза'),
('SB-2025-0074', 'Гордість і упередження', 'Джейн Остін', 'Роман про кохання та суспільство', 'Класична проза'),
('SB-2025-0075', 'Великі сподівання', 'Чарльз Діккенс', 'Роман про життя Піпа', 'Класична проза'),
('SB-2025-0076', 'Олівер Твіст', 'Чарльз Діккенс', 'Роман про сироту Олівера', 'Класична проза'),
('SB-2025-0077', 'Дракула', 'Брем Стокер', 'Готичний роман про вампіра', 'Фентезі, підлітковий вік'),
('SB-2025-0078', 'Франкенштейн', 'Мері Шеллі', 'Готичний роман про створення монстра', 'Фентезі, підлітковий вік'),
('SB-2025-0079', 'Доктор Живаго', 'Борис Пастернак', 'Роман про кохання під час революції', 'Класична проза'),
('SB-2025-0080', 'Тихий Дон', 'Михайло Шолохов', 'Епічний роман про козацьке життя', 'Класична проза'),
('SB-2025-0081', 'Архіпелаг ГУЛАГ', 'Олександр Солженіцин', 'Документальний роман про радянські табори', 'Класична проза'),
('SB-2025-0082', 'Один день Івана Денисовича', 'Олександр Солженіцин', 'Повість про життя в таборі', 'Класична проза'),
('SB-2025-0083', 'Лоліта', 'Володимир Набоков', 'Роман про кохання до неповнолітньої', 'Сучасна проза'),
('SB-2025-0084', 'Біла гвардія', 'Михайло Булгаков', 'Роман про громадянську війну в Україні', 'Класична проза'),
('SB-2025-0085', 'Собаче серце', 'Михайло Булгаков', 'Сатирична повість про експеримент', 'Класична проза'),
('SB-2025-0086', 'Золоте теля', 'Ілля Ільф і Євген Петров', 'Сатиричний роман про афериста', 'Класична проза'),
('SB-2025-0087', 'Дванадцять стільців', 'Ілля Ільф і Євген Петров', 'Сатиричний роман про пошуки скарбів', 'Класична проза'),
('SB-2025-0088', 'Майстер і Маргарита', 'Михайло Булгаков', 'Фантастичний роман про діаволів та кохання', 'Фентезі, підлітковий вік'),
('SB-2025-0089', 'Сонячний удар', 'Іван Бунин', 'Збірка оповідань про кохання', 'Класична проза'),
('SB-2025-0090', 'Темні алеї', 'Іван Бунин', 'Збірка оповідань про кохання', 'Класична проза'),

-- Книги 91-105 (Современная литература и дополнительные классики)
('SB-2025-0091', 'Сто років самотності', 'Габріель Гарсія Маркес', 'Магічний реалізм про рід Буендіа', 'Сучасна проза'),
('SB-2025-0092', 'Любов під час холери', 'Габріель Гарсія Маркес', 'Роман про кохання, яке триває півстоліття', 'Сучасна проза'),
('SB-2025-0093', 'Старий і море', 'Ернест Хемінгуей', 'Повість про рибалку Сантьяго', 'Класична проза'),
('SB-2025-0094', 'Прощавай, зброє!', 'Ернест Хемінгуей', 'Роман про Першу світову війну', 'Класична проза'),
('SB-2025-0095', 'Великий Гетсбі', 'Френсіс Скотт Фіцджеральд', 'Роман про американську мрію', 'Класична проза'),
('SB-2025-0096', 'Убити пересмішника', 'Харпер Лі', 'Роман про расову несправедливість', 'Класична проза'),
('SB-2025-0097', 'Над зозулиним гніздом', 'Кен Кізі', 'Роман про психіатричну лікарню', 'Сучасна проза'),
('SB-2025-0098', 'Хоббіт', 'Джон Рональд Руел Толкін', 'Казка про пригоди хоббіта Більбо', 'Фентезі, підлітковий вік'),
('SB-2025-0099', 'Сильмариліон', 'Джон Рональд Руел Толкін', 'Міфологія Середзем''я', 'Фентезі, підлітковий вік'),
('SB-2025-0100', 'Відьмак. Меч призначення', 'Анджей Сапковський', 'Збірка оповідань про Геральта', 'Фентезі, підлітковий вік'),
('SB-2025-0101', 'Відьмак. Справа Божої кари', 'Анджей Сапковський', 'Продовження пригод Геральта', 'Фентезі, підлітковий вік'),
('SB-2025-0102', 'Відьмак. Погані вісті', 'Анджей Сапковський', 'Третя книга про Геральта', 'Фентезі, підлітковий вік'),
('SB-2025-0103', 'Відьмак. Вежа ластівки', 'Анджей Сапковський', 'Четверта книга про Геральта', 'Фентезі, підлітковий вік'),
('SB-2025-0104', 'Відьмак. Володарка озера', 'Анджей Сапковський', 'П''ята книга про Геральта', 'Фентезі, підлітковий вік'),
('SB-2025-0105', 'Відьмак. Сезон гроз', 'Анджей Сапковський', 'Шоста книга про Геральта', 'Фентезі, підлітковий вік');

-- Обновляем все книги с правильными данными
UPDATE public.books 
SET 
    title = cbd.title,
    author = cbd.author,
    description = cbd.description,
    category_id = find_category_by_parts(cbd.category),
    updated_at = NOW()
FROM correct_books_data cbd
WHERE public.books.code = cbd.code;

-- Проверяем результат
SELECT 
    'Всі 105 книг оновлено!' as status,
    COUNT(*) as total_books,
    COUNT(CASE WHEN title NOT LIKE 'Книга %' AND title NOT LIKE 'Book %' THEN 1 END) as books_with_real_titles,
    COUNT(CASE WHEN author NOT LIKE 'Автор %' AND author NOT LIKE 'Author %' THEN 1 END) as books_with_real_authors
FROM public.books;

-- Показываем обновленные книги
SELECT 
    code,
    title,
    author,
    available
FROM public.books
ORDER BY code
LIMIT 20;
