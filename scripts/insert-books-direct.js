#!/usr/bin/env node

/**
 * –ü—Ä—è–º–∞—è –≤—Å—Ç–∞–≤–∫–∞ –∫–Ω–∏–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Supabase API
 * –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SQL —Ñ–∞–π–ª–æ–≤
 */

const { createClient } = require('@supabase/supabase-js');
const path = require('path');

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
require('dotenv').config({ path: path.join(__dirname, '..', '.env.local') });

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseKey) {
  console.error('‚ùå –û—à–∏–±–∫–∞: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Supabase');
  process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseKey);

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤ –∫–Ω–∏–≥
function generateBookCode(category, index) {
  const categoryPrefixes = {
    '–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞': 'PL',
    '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞': 'DL', 
    '–ö–Ω–∏–∂–∫–∏-–∫–∞—Ä—Ç–∏–Ω–∫–∏': 'KP',
    '–ö–ª–∞—Å–∏—á–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞': 'KL',
    '–ù–∞—É–∫–æ–≤–æ-–ø–æ–ø—É–ª—è—Ä–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞': 'NP',
    '–§–µ–Ω—Ç–µ–∑—ñ —Ç–∞ –ø—Ä–∏–≥–æ–¥–∏': 'FP',
    '–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è —Ç–∞ —Ä–æ–∑–≤–∏—Ç–æ–∫': 'PD',
    '–Ü—Å—Ç–æ—Ä–∏—á–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞': 'IL'
  };
  
  const prefix = categoryPrefixes[category] || 'BK';
  return `${prefix}-${String(index).padStart(3, '0')}`;
}

// –î–∞–Ω–Ω—ã–µ –æ –∫–Ω–∏–≥–∞—Ö –∏–∑ –≤–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞
const booksData = [
  {
    code: 'PL-001',
    title: '–°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∞ —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ª—é–±–æ–≤—ñ –∑ –ø–µ—Ä—à–æ–≥–æ –ø–æ–≥–ª—è–¥—É',
    author: '–î–∂–µ–Ω–Ω—ñ—Ñ–µ—Ä –ï. –°–º—ñ—Ç',
    category: '–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∏–π —Ä–æ–º–∞–Ω –ø—Ä–æ –≤–∏–ø–∞–¥–∫–æ–≤—É –∑—É—Å—Ç—Ä—ñ—á –≤ –∞–µ—Ä–æ–ø–æ—Ä—Ç—É, —â–æ –∑–º—ñ–Ω—é—î –≤—Å–µ. –Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ –∫–æ—Ö–∞–Ω–Ω—è, –≤–∏–ø–∞–¥–∫–æ–≤—ñ—Å—Ç—å —Ç–∞ —Ç–µ, —è–∫ –æ–¥–Ω–µ –º–∏—Ç—å –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ –≤—Å–µ –∂–∏—Ç—Ç—è.',
    short_description: '–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∏–π —Ä–æ–º–∞–Ω –ø—Ä–æ –≤–∏–ø–∞–¥–∫–æ–≤—É –∑—É—Å—Ç—Ä—ñ—á –≤ –∞–µ—Ä–æ–ø–æ—Ä—Ç—É, —â–æ –∑–º—ñ–Ω—é—î –≤—Å–µ.',
    isbn: '978-966-448-410-4',
    pages: 248,
    age_range: '14+',
    publisher: '–í–∏–¥–∞–≤–Ω–∏—Ü—Ç–≤–æ –°—Ç–∞—Ä–æ–≥–æ –õ–µ–≤–∞',
    publication_year: 2025,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–ù–æ–≤–µ', '–ü–æ–ø—É–ª—è—Ä–Ω–µ'],
    tags: ['—Ä–æ–º–∞–Ω', '–ø—ñ–¥–ª—ñ—Ç–∫–∏', '–∫–æ—Ö–∞–Ω–Ω—è', '–ø—Ä–∏–≥–æ–¥–∏']
  },
  {
    code: 'PL-002',
    title: '–ö–æ—Å–º–æ—Å, –ø—Ä–∏–π–æ–º',
    author: '–ú–∞—Ä–∫ –õ—ñ–≤—ñ–Ω',
    category: '–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ö–∞–º—ñ–Ω–≥-–æ—Ñ-–µ–π–¥–∂ –ø—Ä–æ –ø–æ—à—É–∫–∏ –±–∞—Ç—å–∫–∞ –π –≤–ª–∞—Å–Ω–æ–≥–æ –≥–æ–ª–æ—Å—É. –Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ –¥–æ—Ä–æ—Å–ª—ñ—à–∞–Ω–Ω—è, —Å–∞–º–æ–ø—ñ–∑–Ω–∞–Ω–Ω—è —Ç–∞ –ø–æ—à—É–∫ —Å–≤–æ—î—ó —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ.',
    short_description: '–ö–∞–º—ñ–Ω–≥-–æ—Ñ-–µ–π–¥–∂ –ø—Ä–æ –ø–æ—à—É–∫–∏ –±–∞—Ç—å–∫–∞ –π –≤–ª–∞—Å–Ω–æ–≥–æ –≥–æ–ª–æ—Å—É.',
    isbn: '9789669827630',
    pages: 240,
    age_range: '14+',
    publisher: 'Vivat',
    publication_year: 2023,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–ü–æ–ø—É–ª—è—Ä–Ω–µ'],
    tags: ['—Ä–æ–º–∞–Ω', '–ø—ñ–¥–ª—ñ—Ç–∫–∏', '–¥–æ—Ä–æ—Å–ª—ñ—à–∞–Ω–Ω—è', '—Å—ñ–º\'—è']
  },
  {
    title: '–ù–µ–∑–¥–∞—Ç–Ω—ñ',
    author: '–ú–∞—Ä—Ç—ñ–Ω –†. –†–æ—à–µ',
    category: '–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –ø—Ä–æ–∑–∞ –ø—Ä–æ ¬´–ø—Ä–∞–≤–æ –Ω–∞ –ø–æ–º–∏–ª–∫—É¬ª –≤ —Å—É—á–∞—Å–Ω–æ–º—É —Å—É—Å–ø—ñ–ª—å—Å—Ç–≤—ñ. –ì–ª–∏–±–æ–∫–∏–π —Ä–æ–∑–≥–ª—è–¥ –ø—Ä–æ–±–ª–µ–º —Å—É—á–∞—Å–Ω–æ—ó –º–æ–ª–æ–¥—ñ —Ç–∞ —ó—Ö –±–æ—Ä–æ—Ç—å–±–∏ –∑ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º–∏.',
    short_description: '–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—á–Ω–∞ –ø—Ä–æ–∑–∞ –ø—Ä–æ ¬´–ø—Ä–∞–≤–æ –Ω–∞ –ø–æ–º–∏–ª–∫—É¬ª –≤ —Å—É—á–∞—Å–Ω–æ–º—É —Å—É—Å–ø—ñ–ª—å—Å—Ç–≤—ñ.',
    isbn: '9789669826992',
    pages: 272,
    age_range: '16+',
    publisher: 'Vivat',
    publication_year: 2023,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–°–µ—Ä–π–æ–∑–Ω–µ'],
    tags: ['–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è', '–ø—ñ–¥–ª—ñ—Ç–∫–∏', '—Å—É—Å–ø—ñ–ª—å—Å—Ç–≤–æ', '–ø–æ–º–∏–ª–∫–∏']
  },
  {
    title: '–ó–Ω–∞–º–µ–Ω–∏—Ç—ñ —Ç–∞–∫–æ–∂ –∑–∞–∫–æ—Ö—É—é—Ç—å—Å—è',
    author: '–ö—ñ—Ä—Å—Ç—ñ –ö—Ä—ñ—Å—Ç–æ—Ñ—Ñ–µ—Ä—Å–µ–Ω',
    category: '–ù–∞—É–∫–æ–≤–æ-–ø–æ–ø—É–ª—è—Ä–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ü–æ–ø—É–ª—è—Ä–Ω–∏–π –Ω–æ–Ω-—Ñ—ñ–∫—à–Ω –ø—Ä–æ –ø—Ä–∏–≤–∞—Ç–Ω–µ –∂–∏—Ç—Ç—è –≤—ñ–¥–æ–º–∏—Ö –ø–æ—Å—Ç–∞—Ç–µ–π —É —Ñ–æ—Ä–º–∞—Ç—ñ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–º–∞–ª—å–æ–≤–æ–∫. –¶—ñ–∫–∞–≤—ñ —Ñ–∞–∫—Ç–∏ –ø—Ä–æ –æ—Å–æ–±–∏—Å—Ç–µ –∂–∏—Ç—Ç—è –∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç–µ–π.',
    short_description: '–ü–æ–ø—É–ª—è—Ä–Ω–∏–π –Ω–æ–Ω-—Ñ—ñ–∫—à–Ω –ø—Ä–æ –ø—Ä–∏–≤–∞—Ç–Ω–µ –∂–∏—Ç—Ç—è –≤—ñ–¥–æ–º–∏—Ö –ø–æ—Å—Ç–∞—Ç–µ–π —É —Ñ–æ—Ä–º–∞—Ç—ñ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–º–∞–ª—å–æ–≤–æ–∫.',
    isbn: null,
    pages: 96,
    age_range: '12+',
    publisher: '–í–°–õ',
    publication_year: 2022,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–¶—ñ–∫–∞–≤–µ'],
    tags: ['–±—ñ–æ–≥—Ä–∞—Ñ—ñ—ó', '–∑–Ω–∞–º–µ–Ω–∏—Ç–æ—Å—Ç—ñ', '—ñ—Å—Ç–æ—Ä—ñ—ó', '—Ñ–∞–∫—Ç–∏']
  },
  {
    title: '–ü—ñ–≤–¥–µ–Ω—å',
    author: '–õ–µ–∞ –ö–æ–µ–Ω',
    category: '–ö–ª–∞—Å–∏—á–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–°—ñ–º–µ–π–Ω–∞ —Å–∞–≥–∞ –Ω–∞ —Ç–ª—ñ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–ª–∞–º—ñ–≤. –ï–ø—ñ—á–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è —Å—ñ–º\'—ó —á–µ—Ä–µ–∑ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è, —â–æ –ø–æ–∫–∞–∑—É—î —è–∫ —ñ—Å—Ç–æ—Ä–∏—á–Ω—ñ –ø–æ–¥—ñ—ó –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –¥–æ–ª—ñ –ª—é–¥–µ–π.',
    short_description: '–°—ñ–º–µ–π–Ω–∞ —Å–∞–≥–∞ –Ω–∞ —Ç–ª—ñ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–ª–∞–º—ñ–≤.',
    isbn: '9786178111776',
    pages: 336,
    age_range: '16+',
    publisher: '–ù–∞—à –§–æ—Ä–º–∞—Ç',
    publication_year: 2024,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–°–µ—Ä–π–æ–∑–Ω–µ', '–ö–ª–∞—Å–∏–∫–∞'],
    tags: ['—Å–∞–≥–∞', '—Å—ñ–º\'—è', '—ñ—Å—Ç–æ—Ä—ñ—è', '–ø–æ–∫–æ–ª—ñ–Ω–Ω—è']
  },
  {
    title: '–õ–∏—Ü–∞—Ä-–¥—Ä–∞–∫–æ–Ω. –í–æ–≥–æ–Ω—å! (–∫–Ω. 1)',
    author: '–ö–∞–π–ª –ú º—é–±—å–æ—Ä–Ω',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ö—É–º–µ–¥–Ω–µ —Ñ–µ–Ω—Ç–µ–∑—ñ –¥–ª—è –º–æ–ª–æ–¥—à–∏—Ö —á–∏—Ç–∞—á—ñ–≤. –ü—Ä–∏–≥–æ–¥–∏ —é–Ω–æ–≥–æ –ª–∏—Ü–∞—Ä—è-–¥—Ä–∞–∫–æ–Ω–∞, —è–∫–∏–π –Ω–∞–≤—á–∞—î—Ç—å—Å—è –±—É—Ç–∏ –≥–µ—Ä–æ—î–º.',
    short_description: '–ö—É–º–µ–¥–Ω–µ —Ñ–µ–Ω—Ç–µ–∑—ñ –¥–ª—è –º–æ–ª–æ–¥—à–∏—Ö —á–∏—Ç–∞—á—ñ–≤.',
    isbn: '9786177682239',
    pages: 96,
    age_range: '6-10',
    publisher: 'Vivat',
    publication_year: 2019,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–í–µ—Å–µ–ª–µ', '–°–µ—Ä—ñ—è'],
    tags: ['—Ñ–µ–Ω—Ç–µ–∑—ñ', '–ø—Ä–∏–≥–æ–¥–∏', '–ª–∏—Ü–∞—Ä', '–¥—Ä–∞–∫–æ–Ω', '–¥—ñ—Ç–∏']
  },
  {
    title: '–õ–∏—Ü–∞—Ä-–¥—Ä–∞–∫–æ–Ω. –¢—É—Ä–Ω—ñ—Ä (–∫–Ω. 2)',
    author: '–ö–∞–π–ª –ú º—é–±—å–æ—Ä–Ω',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ü—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –ø—Ä–∏–≥–æ–¥ —é–Ω–æ–≥–æ ¬´–ª–∏—Ü–∞—Ä—è-–¥—Ä–∞–∫–æ–Ω–∞¬ª. –î—Ä—É–≥–∞ —á–∞—Å—Ç–∏–Ω–∞ —Å–µ—Ä—ñ—ó –ø—Ä–æ —Å–º—ñ—à–Ω—ñ –ø—Ä–∏–≥–æ–¥–∏ –≥–µ—Ä–æ—è.',
    short_description: '–ü—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –ø—Ä–∏–≥–æ–¥ —é–Ω–æ–≥–æ ¬´–ª–∏—Ü–∞—Ä—è-–¥—Ä–∞–∫–æ–Ω–∞¬ª.',
    isbn: '9786177685315',
    pages: 96,
    age_range: '6-10',
    publisher: 'Vivat',
    publication_year: 2019,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–í–µ—Å–µ–ª–µ', '–°–µ—Ä—ñ—è'],
    tags: ['—Ñ–µ–Ω—Ç–µ–∑—ñ', '–ø—Ä–∏–≥–æ–¥–∏', '–ª–∏—Ü–∞—Ä', '–¥—Ä–∞–∫–æ–Ω', '–¥—ñ—Ç–∏']
  },
  {
    title: '–ó–∞–≥—É–±–∏–≤—Å—è —Ç–∏–≥—Ä! (—Å–µ—Ä—ñ—è ¬´–Ø –≤–∂–µ —á–∏—Ç–∞—é¬ª)',
    author: '–ö–∞—Ç–∞–∂–∏–Ω–∞ –®–µ—Å—Ç–∞–∫',
    category: '–ö–Ω–∏–∂–∫–∏-–∫–∞—Ä—Ç–∏–Ω–∫–∏',
    description: '–ü–µ—Ä—à–∏–π —Å–∞–º–æ—Å—Ç—ñ–π–Ω–∏–π —á–∏—Ç–∞—á: —è—Å–∫—Ä–∞–≤–∞ —ñ—Å—Ç–æ—Ä—ñ—è-–ø—Ä–∏–≥–æ–¥–∞. –ö–Ω–∏–≥–∞ –¥–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤ —á–∏—Ç–∞–Ω–Ω—è –∑ –≤–µ–ª–∏–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏ —Ç–∞ —Ü—ñ–∫–∞–≤–∏–º–∏ –ø—Ä–∏–≥–æ–¥–∞–º–∏.',
    short_description: '–ü–µ—Ä—à–∏–π —Å–∞–º–æ—Å—Ç—ñ–π–Ω–∏–π —á–∏—Ç–∞—á: —è—Å–∫—Ä–∞–≤–∞ —ñ—Å—Ç–æ—Ä—ñ—è-–ø—Ä–∏–≥–æ–¥–∞.',
    isbn: '9786170982421',
    pages: 48,
    age_range: '5-8',
    publisher: '–†–∞–Ω–æ–∫',
    publication_year: 2023,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–î–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤', '–°–µ—Ä—ñ—è'],
    tags: ['—á–∏—Ç–∞–Ω–Ω—è', '–ø—Ä–∏–≥–æ–¥–∏', '—Ç–∏–≥—Ä', '–¥—ñ—Ç–∏', '–Ω–∞–≤—á–∞–Ω–Ω—è']
  },
  {
    title: '–ù–µ–π–º–æ–≤—ñ—Ä–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ –≤–µ–ª–µ—Ç-–≥—Ä—É—à–∫—É',
    author: '–Ø–∫–æ–± –ú–∞—Ä—Ç—ñ–Ω –°—Ç—Ä—ñ–¥',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ê–≤–∞–Ω—Ç—é—Ä–Ω–∞ –∫–∞–∑–∫–∞ –∑ —É–ø—ñ–∑–Ω–∞–≤–∞–Ω–æ—é –≥—Ä–∞—Ñ—ñ–∫–æ—é. –í–µ—Å–µ–ª–∞ —ñ—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ –≤–µ–ª–∏—á–µ–∑–Ω—É –≥—Ä—É—à—É —Ç–∞ —ó—ó –ø—Ä–∏–≥–æ–¥–∏.',
    short_description: '–ê–≤–∞–Ω—Ç—é—Ä–Ω–∞ –∫–∞–∑–∫–∞ –∑ —É–ø—ñ–∑–Ω–∞–≤–∞–Ω–æ—é –≥—Ä–∞—Ñ—ñ–∫–æ—é.',
    isbn: '9786170963253',
    pages: 160,
    age_range: '6-10',
    publisher: '–†–∞–Ω–æ–∫',
    publication_year: 2019,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–í–µ—Å–µ–ª–µ', '–ö–∞–∑–∫–∞'],
    tags: ['–∫–∞–∑–∫–∞', '–ø—Ä–∏–≥–æ–¥–∏', '–≥—Ä—É—à–∞', '–¥—ñ—Ç–∏', '—Ñ–∞–Ω—Ç–∞–∑—ñ—è']
  },
  {
    title: '–õ–∞–º–∞ –õ–∞–º–∞ —ñ –π–æ–≥–æ –º–∞–º–∞',
    author: '–ê–Ω–Ω–∞ –î\'—é–¥–Ω—ñ',
    category: '–ö–Ω–∏–∂–∫–∏-–∫–∞—Ä—Ç–∏–Ω–∫–∏',
    description: '–¢–µ–ø–ª—ñ —ñ—Å—Ç–æ—Ä—ñ—ó –ø—Ä–æ –º–∞–º—É –π –ª–∞–º–µ–Ω—è. –°–µ—Ä—ñ—è –∫–Ω–∏–≥ –ø—Ä–æ —Å—ñ–º–µ–π–Ω—ñ —Å—Ç–æ—Å—É–Ω–∫–∏ —Ç–∞ –ª—é–±–æ–≤ –º—ñ–∂ –º–∞–º–æ—é —Ç–∞ –¥–∏—Ç–∏–Ω–æ—é.',
    short_description: '–¢–µ–ø–ª—ñ —ñ—Å—Ç–æ—Ä—ñ—ó –ø—Ä–æ –º–∞–º—É –π –ª–∞–º–µ–Ω—è.',
    isbn: '9786178253875',
    pages: 96,
    age_range: '3-6',
    publisher: 'Vivat',
    publication_year: 2022,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–¢–µ–ø–ª–µ', '–°–µ—Ä—ñ—è'],
    tags: ['—Å—ñ–º\'—è', '–º–∞–º–∞', '–¥–∏—Ç–∏–Ω–∞', '–ª—é–±–æ–≤', '–º–∞–ª—è—Ç–∞']
  },
  {
    title: '–î–≤—ñ –±—ñ–ª–∫–∏ —ñ —à–∏—à–∫–∞ –∑ –≥—ñ–ª–∫–∏',
    author: '–†–µ–π—á–µ–ª –ë—Ä–∞–π—Ç',
    category: '–ö–Ω–∏–∂–∫–∏-–∫–∞—Ä—Ç–∏–Ω–∫–∏',
    description: '–ö—É–º–µ–¥–Ω–∞ –ø—Ä–∏—Ç—á–∞ –ø—Ä–æ —Å–ø—ñ–≤–ø—Ä–∞—Ü—é –∑–∞–º—ñ—Å—Ç—å –∑–º–∞–≥–∞–Ω–Ω—è. –Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ —Ç–µ, —è–∫ –∫—Ä–∞—â–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —Ä–∞–∑–æ–º, –Ω—ñ–∂ –∑–º–∞–≥–∞—Ç–∏—Å—è.',
    short_description: '–ö—É–º–µ–¥–Ω–∞ –ø—Ä–∏—Ç—á–∞ –ø—Ä–æ —Å–ø—ñ–≤–ø—Ä–∞—Ü—é –∑–∞–º—ñ—Å—Ç—å –∑–º–∞–≥–∞–Ω–Ω—è.',
    isbn: '9789669821973',
    pages: 32,
    age_range: '3-6',
    publisher: 'Vivat',
    publication_year: 2021,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–ü–æ–≤—á–∞–ª—å–Ω–µ', '–í–µ—Å–µ–ª–µ'],
    tags: ['–ø—Ä–∏—Ç—á–∞', '—Å–ø—ñ–≤–ø—Ä–∞—Ü—è', '–±—ñ–ª–∫–∏', '–¥—Ä—É–∂–±–∞', '–º–∞–ª—è—Ç–∞']
  },
  {
    title: '–Ø–π—Ü–µ. –î—Ä—É–∑—è–∫–∏-–¥–∏–Ω–æ–∑–∞–≤—Ä–∏–∫–∏',
    author: '–õ–∞—Ä—Å –ú–µ–ª–µ',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ü–æ–¥–æ—Ä–æ–∂ –¥—Ä—É–∑—ñ–≤-–¥–∏–Ω–æ–∑–∞–≤—Ä–∏–∫—ñ–≤ –¥–æ –≤–µ–ª–∏–∫–æ—ó –ø–æ–¥—ñ—ó. –ü—Ä–∏–≥–æ–¥–∏ –º–∏–ª–∏—Ö –¥–∏–Ω–æ–∑–∞–≤—Ä–∏–∫—ñ–≤, —è–∫—ñ —Ä–∞–∑–æ–º –≤–∏—Ä—É—à–∞—é—Ç—å —É –ø–æ–¥–æ—Ä–æ–∂.',
    short_description: '–ü–æ–¥–æ—Ä–æ–∂ –¥—Ä—É–∑—ñ–≤-–¥–∏–Ω–æ–∑–∞–≤—Ä–∏–∫—ñ–≤ –¥–æ –≤–µ–ª–∏–∫–æ—ó –ø–æ–¥—ñ—ó.',
    isbn: '9786170977014',
    pages: 48,
    age_range: '4-8',
    publisher: '–†–∞–Ω–æ–∫',
    publication_year: 2022,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–í–µ—Å–µ–ª–µ', '–î—Ä—É–∂–±–∞'],
    tags: ['–¥–∏–Ω–æ–∑–∞–≤—Ä–∏', '–¥—Ä—É–∂–±–∞', '–ø–æ–¥–æ—Ä–æ–∂', '–¥—ñ—Ç–∏', '–ø—Ä–∏–≥–æ–¥–∏']
  },
  {
    title: '–ß—É–¥–æ–≤–µ –ß—É–¥–æ–≤–∏—Å—å–∫–æ. –í –∫—Ä–∞—ó–Ω—ñ –∂–∞—Ö–æ–≤–∏—Å—å–∫ (–∫–Ω. 2)',
    author: '–°–∞—à–∫–æ –î–µ—Ä–º–∞–Ω—Å—å–∫–∏–π',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–î—Ä—É–≥–∞ —á–∞—Å—Ç–∏–Ω–∞ —à–∞–ª–µ–Ω–æ—ó —Ç—Ä–∏–ª–æ–≥—ñ—ó –ø—Ä–æ –°–æ–Ω—é —ñ –ß—É. –ü—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –ø—Ä–∏–≥–æ–¥ –¥—ñ–≤—á–∏–Ω–∫–∏ —Ç–∞ —ó—ó –Ω–µ–∑–≤–∏—á–∞–π–Ω–æ–≥–æ –¥—Ä—É–≥–∞.',
    short_description: '–î—Ä—É–≥–∞ —á–∞—Å—Ç–∏–Ω–∞ —à–∞–ª–µ–Ω–æ—ó —Ç—Ä–∏–ª–æ–≥—ñ—ó –ø—Ä–æ –°–æ–Ω—é —ñ –ß—É.',
    isbn: '9786175850015',
    pages: 288,
    age_range: '7-12',
    publisher: '–ê-–±–∞-–±–∞-–≥–∞-–ª–∞-–º–∞-–≥–∞',
    publication_year: 2021,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–°–µ—Ä—ñ—è', '–§–µ–Ω—Ç–µ–∑—ñ'],
    tags: ['—Ñ–µ–Ω—Ç–µ–∑—ñ', '–ø—Ä–∏–≥–æ–¥–∏', '–¥—Ä—É–∂–±–∞', '–¥—ñ—Ç–∏', '—Ç—Ä–∏–ª–æ–≥—ñ—è']
  },
  {
    title: '–£–∫—Ä–∞—ó–Ω–æ–∑–Ω–∞–≤—Ü—ñ: –£–∫—Ä–∞—ó–Ω–∞. –í—ñ–¥ –ø–µ—Ä–≤—ñ—Å–Ω–∏—Ö —á–∞—Å—ñ–≤ –¥–æ —Å—å–æ–≥–æ–¥–µ–Ω–Ω—è',
    author: '–°–µ—Ä–≥—ñ–π –ñ—É–∫–æ–≤, –ú–∞—Ä—ñ—è –¢–∞—Ö—Ç–∞—É–ª–æ–≤–∞',
    category: '–Ü—Å—Ç–æ—Ä–∏—á–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–Ü–ª—é—Å—Ç—Ä–æ–≤–∞–Ω–∏–π –≥—ñ–¥ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó –£–∫—Ä–∞—ó–Ω–∏ –¥–ª—è –¥—ñ—Ç–µ–π. –ü–æ–≤–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è –Ω–∞—à–æ—ó –∫—Ä–∞—ó–Ω–∏ —É –∑—Ä–æ–∑—É–º—ñ–ª–æ–º—É –¥–ª—è –¥—ñ—Ç–µ–π —Ñ–æ—Ä–º–∞—Ç—ñ.',
    short_description: '–Ü–ª—é—Å—Ç—Ä–æ–≤–∞–Ω–∏–π –≥—ñ–¥ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó –£–∫—Ä–∞—ó–Ω–∏ –¥–ª—è –¥—ñ—Ç–µ–π.',
    isbn: '978-617-09-8655-9',
    pages: 104,
    age_range: '8-14',
    publisher: '–†–∞–Ω–æ–∫',
    publication_year: 2024,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–û—Å–≤—ñ—Ç–Ω—î', '–Ü—Å—Ç–æ—Ä—ñ—è'],
    tags: ['—ñ—Å—Ç–æ—Ä—ñ—è', '–£–∫—Ä–∞—ó–Ω–∞', '–æ—Å–≤—ñ—Ç–∞', '–¥—ñ—Ç–∏', '–ø—ñ–∑–Ω–∞–≤–∞–ª—å–Ω–µ']
  },
  {
    title: '–ú–æ—Ä—Ç—ñ–Ω–∞ —ñ –¢–∞—î–º–Ω–∏—á–µ –æ–∑–µ—Ä–æ',
    author: '–ë–∞—Ä–±–∞—Ä–∞ –ö–∞–Ω—Ç—ñ–Ω—ñ',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ì–æ—Ç–∏—á–Ω–æ-–∫—É–º–µ–¥–Ω—ñ –∫–∞–Ω—ñ–∫—É–ª–∏ –ú–æ—Ä—Ç—ñ–Ω–∏. –ü—Ä–∏–≥–æ–¥–∏ –º–∞–ª–µ–Ω—å–∫–æ—ó –¥—ñ–≤—á–∏–Ω–∫–∏-—Å–∫–µ–ª–µ—Ç–∞ —É —Ç–∞—î–º–Ω–∏—á–æ–º—É –æ–∑–µ—Ä—ñ.',
    short_description: '–ì–æ—Ç–∏—á–Ω–æ-–∫—É–º–µ–¥–Ω—ñ –∫–∞–Ω—ñ–∫—É–ª–∏ –ú–æ—Ä—Ç—ñ–Ω–∏.',
    isbn: '9789669178060',
    pages: 80,
    age_range: '6-10',
    publisher: '–†—ñ–¥–Ω–∞ –ú–æ–≤–∞',
    publication_year: 2024,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–í–µ—Å–µ–ª–µ', '–ì–æ—Ç–∏–∫–∞'],
    tags: ['–ø—Ä–∏–≥–æ–¥–∏', '—Å–∫–µ–ª–µ—Ç', '–æ–∑–µ—Ä–æ', '–¥—ñ—Ç–∏', '—Ç–∞—î–º–Ω–∏—Ü—è']
  },
  {
    title: '–†–æ–± —ñ –î–∂–æ–Ω–Ω—ñ. –ö–Ω–∏–≥–∞ 1',
    author: '–ï–ª—ñ–∑–∞–±–µ—Ç –ú–µ—Ç—ñ—Å',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–î—Ä—É–∂–±–∞, –ø—Ä–∏–≥–æ–¥–∏ –π —Ç—Ä–æ—à–∫–∏ —à–∞–ª–µ–Ω—Å—Ç–≤–∞. –Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ –¥–≤–æ—Ö –¥—Ä—É–∑—ñ–≤ —Ç–∞ —ó—Ö –Ω–µ–π–º–æ–≤—ñ—Ä–Ω—ñ –ø—Ä–∏–≥–æ–¥–∏.',
    short_description: '–î—Ä—É–∂–±–∞, –ø—Ä–∏–≥–æ–¥–∏ –π —Ç—Ä–æ—à–∫–∏ —à–∞–ª–µ–Ω—Å—Ç–≤–∞.',
    isbn: '9786178071018',
    pages: 96,
    age_range: '6-10',
    publisher: 'Talantbooks',
    publication_year: 2024,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–î—Ä—É–∂–±–∞', '–ü—Ä–∏–≥–æ–¥–∏'],
    tags: ['–¥—Ä—É–∂–±–∞', '–ø—Ä–∏–≥–æ–¥–∏', '–¥—ñ—Ç–∏', '—à–∞–ª–µ–Ω—Å—Ç–≤–æ', '–≤–µ—Å–µ–ª–æ—â—ñ']
  },
  {
    title: '–ü—Ä–∏—Ç—á—ñ. –ú—É–¥—Ä—ñ—Å—Ç—å –ø–æ–∫–æ–ª—ñ–Ω—å',
    author: '—É–ø–æ—Ä—è–¥. –Ü–†–Ü–û (IPIO)',
    category: '–ö–ª–∞—Å–∏—á–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ó–±—ñ—Ä–∫–∞ –ø–æ–≤—á–∞–ª—å–Ω–∏—Ö —ñ—Å—Ç–æ—Ä—ñ–π –¥–ª—è –¥–æ—Ä–æ—Å–ª–∏—Ö —ñ –ø—ñ–¥–ª—ñ—Ç–∫—ñ–≤. –ú—É–¥—Ä—ñ –ø—Ä–∏—Ç—á—ñ, —è–∫—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å –º—É–¥—Ä—ñ—Å—Ç—å –ø–æ–∫–æ–ª—ñ–Ω—å.',
    short_description: '–ó–±—ñ—Ä–∫–∞ –ø–æ–≤—á–∞–ª—å–Ω–∏—Ö —ñ—Å—Ç–æ—Ä—ñ–π –¥–ª—è –¥–æ—Ä–æ—Å–ª–∏—Ö —ñ –ø—ñ–¥–ª—ñ—Ç–∫—ñ–≤.',
    isbn: '978-617-7754-52-6',
    pages: 240,
    age_range: '12+',
    publisher: '–Ü–†–Ü–û',
    publication_year: 2023,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–ú—É–¥—Ä—ñ—Å—Ç—å', '–ö–ª–∞—Å–∏–∫–∞'],
    tags: ['–ø—Ä–∏—Ç—á—ñ', '–º—É–¥—Ä—ñ—Å—Ç—å', '–ø–æ–≤—á–∞–Ω–Ω—è', '–ø–æ–∫–æ–ª—ñ–Ω–Ω—è', '—Ñ—ñ–ª–æ—Å–æ—Ñ—ñ—è']
  },
  {
    title: '–û—Å—ñ–Ω—å –Ω–∞ –ë—É–∑–∏–Ω–æ–≤—ñ–π –≤—É–ª–∏—Ü—ñ',
    author: '–ß–æ—Ä–Ω—ñ –í—ñ–≤—Ü—ñ',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–¢–µ–ø–ª—ñ –¥–≤–æ—Ä–∏–∫–æ–≤—ñ —ñ—Å—Ç–æ—Ä—ñ—ó –ø—Ä–æ –¥—Ä—É–∂–±—É —Ç–∞ –±—É–¥–Ω—ñ. –°–µ—Ä—ñ—è –æ–ø–æ–≤—ñ–¥–∞–Ω—å –ø—Ä–æ –∂–∏—Ç—Ç—è –¥—ñ—Ç–µ–π –Ω–∞ –æ–¥–Ω—ñ–π –≤—É–ª–∏—Ü—ñ.',
    short_description: '–¢–µ–ø–ª—ñ –¥–≤–æ—Ä–∏–∫–æ–≤—ñ —ñ—Å—Ç–æ—Ä—ñ—ó –ø—Ä–æ –¥—Ä—É–∂–±—É —Ç–∞ –±—É–¥–Ω—ñ.',
    isbn: '9789669820549',
    pages: 64,
    age_range: '6-10',
    publisher: '–ß–æ—Ä–Ω—ñ –í—ñ–≤—Ü—ñ',
    publication_year: 2019,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–¢–µ–ø–ª–µ', '–°–µ—Ä—ñ—è'],
    tags: ['–¥—Ä—É–∂–±–∞', '–¥–≤–æ—Ä–∏–∫', '–¥—ñ—Ç–∏', '–±—É–¥–Ω—ñ', '—Ç–µ–ø–ª–æ']
  },
  {
    title: '–®–≤–∏–¥–∫–∞ –¥–æ–ø–æ–º–æ–≥–∞ –¥–ª—è –¥—ñ—Ç–µ–π',
    author: '–ú–∞—Å–∞—Ö—ñ–∫–æ –°–∞–∫–∞–º–æ—Ç–æ',
    category: '–ù–∞—É–∫–æ–≤–æ-–ø–æ–ø—É–ª—è—Ä–Ω–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–ü—Ä–æ—Å—Ç–∞ –µ–Ω—Ü–∏–∫–ª–æ–ø–µ–¥—ñ—è –ø–µ—Ä—à–æ—ó –¥–æ–ø–æ–º–æ–≥–∏ –¥–ª—è –¥—ñ—Ç–µ–π —ñ –±–∞—Ç—å–∫—ñ–≤. –ù–∞–≤—á–∞–ª—å–Ω–∞ –∫–Ω–∏–≥–∞ –ø—Ä–æ —Ç–µ, —è–∫ –Ω–∞–¥–∞—Ç–∏ –ø–µ—Ä—à—É –¥–æ–ø–æ–º–æ–≥—É.',
    short_description: '–ü—Ä–æ—Å—Ç–∞ –µ–Ω—Ü–∏–∫–ª–æ–ø–µ–¥—ñ—è –ø–µ—Ä—à–æ—ó –¥–æ–ø–æ–º–æ–≥–∏ –¥–ª—è –¥—ñ—Ç–µ–π —ñ –±–∞—Ç—å–∫—ñ–≤.',
    isbn: '978-617-7913-23-7',
    pages: 48,
    age_range: '7+',
    publisher: 'Mamino',
    publication_year: 2024,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–û—Å–≤—ñ—Ç–Ω—î', '–ö–æ—Ä–∏—Å–Ω–µ'],
    tags: ['–ø–µ—Ä—à–∞ –¥–æ–ø–æ–º–æ–≥–∞', '–æ—Å–≤—ñ—Ç–∞', '–±–µ–∑–ø–µ–∫–∞', '–¥—ñ—Ç–∏', '–∫–æ—Ä–∏—Å–Ω–µ']
  },
  {
    title: '–£ –Ω–∞—Å –∑–∞–≤—ñ–≤—Å—è –Ω–µ–≤–∏–¥–∏–º–∏–π —Ç–∏–≥—Ä',
    author: '–ö–∞—Ç–µ—Ä–∏–Ω–∞ –Ñ–≥–æ—Ä—É–∫—ñ–Ω–∞',
    category: '–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è —Ç–∞ —Ä–æ–∑–≤–∏—Ç–æ–∫',
    description: '–Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ —Ç—Ä–∏–≤–æ–≥—É –ø–µ—Ä–µ—ó–∑–¥—É —Ç–∞ ¬´—É—è–≤–Ω–æ–≥–æ –¥—Ä—É–≥–∞¬ª. –ö–Ω–∏–≥–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –¥—ñ—Ç—è–º —Ä–æ–∑—É–º—ñ—Ç–∏ —Ç–∞ –ø–æ–¥–æ–ª–∞—Ç–∏ —Ç—Ä–∏–≤–æ–∂–Ω—ñ—Å—Ç—å.',
    short_description: '–Ü—Å—Ç–æ—Ä—ñ—è –ø—Ä–æ —Ç—Ä–∏–≤–æ–≥—É –ø–µ—Ä–µ—ó–∑–¥—É —Ç–∞ ¬´—É—è–≤–Ω–æ–≥–æ –¥—Ä—É–≥–∞¬ª.',
    isbn: '9786171709157',
    pages: 48,
    age_range: '5-8',
    publisher: 'Vivat',
    publication_year: 2025,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è', '–î–æ–ø–æ–º–æ–≥–∞'],
    tags: ['—Ç—Ä–∏–≤–æ–≥–∞', '–ø–µ—Ä–µ—ó–∑–¥', '–ø—Å–∏—Ö–æ–ª–æ–≥—ñ—è', '–¥—ñ—Ç–∏', '–µ–º–æ—Ü—ñ—ó']
  },
  {
    title: '–ö–ª—É–± –Ω–æ–≤–∏—Ö —Ä–æ–±—ñ–Ω–∑–æ–Ω—ñ–≤',
    author: '“ê—ñ–π–æ–º –î–µ–ª–∞–Ω–Ω–æ–π',
    category: '–î–∏—Ç—è—á–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞',
    description: '–°—É—á–∞—Å–Ω–∏–π ¬´—Ä–æ–±—ñ–Ω–∑–æ–Ω–∞–¥¬ª –¥–ª—è —é–Ω–∏—Ö –¥–æ—Å–ª—ñ–¥–Ω–∏–∫—ñ–≤. –ü—Ä–∏–≥–æ–¥–∏ —Å—É—á–∞—Å–Ω–∏—Ö –¥—ñ—Ç–µ–π, —è–∫—ñ –Ω–∞–≤—á–∞—é—Ç—å—Å—è –≤–∏–∂–∏–≤–∞—Ç–∏ –≤ –ø—Ä–∏—Ä–æ–¥—ñ.',
    short_description: '–°—É—á–∞—Å–Ω–∏–π ¬´—Ä–æ–±—ñ–Ω–∑–æ–Ω–∞–¥¬ª –¥–ª—è —é–Ω–∏—Ö –¥–æ—Å–ª—ñ–¥–Ω–∏–∫—ñ–≤.',
    isbn: null,
    pages: null,
    age_range: '8-12',
    publisher: '–í–°–õ',
    publication_year: 2025,
    status: 'available',
    available: true,
    rating: 0,
    rating_count: 0,
    badges: ['–ü—Ä–∏–≥–æ–¥–∏', '–ù–∞–≤—á–∞–Ω–Ω—è'],
    tags: ['—Ä–æ–±—ñ–Ω–∑–æ–Ω–∞–¥', '–ø—Ä–∏—Ä–æ–¥–∞', '–≤–∏–∂–∏–≤–∞–Ω–Ω—è', '–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è', '–¥—ñ—Ç–∏']
  }
];

async function insertBooks() {
  console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –≤—Å—Ç–∞–≤–∫—É –∫–Ω–∏–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö...\n');
  
  let successCount = 0;
  let errorCount = 0;
  
  for (let i = 0; i < booksData.length; i++) {
    const book = booksData[i];
    
    try {
      console.log(`üìñ –í—Å—Ç–∞–≤–ª—è–µ–º –∫–Ω–∏–≥—É ${i + 1}/${booksData.length}: "${book.title}"`);
      
      const { data, error } = await supabase
        .from('books')
        .insert([book])
        .select();
      
      if (error) {
        console.error(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∫–Ω–∏–≥–∏ "${book.title}":`, error.message);
        errorCount++;
      } else {
        console.log(`‚úÖ –ö–Ω–∏–≥–∞ "${book.title}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞`);
        successCount++;
      }
      
      // –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –≤—Å—Ç–∞–≤–∫–∞–º–∏
      await new Promise(resolve => setTimeout(resolve, 200));
      
    } catch (err) {
      console.error(`‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∫–Ω–∏–≥–∏ "${book.title}":`, err.message);
      errorCount++;
    }
  }
  
  console.log('\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å—Ç–∞–≤–∫–∏:');
  console.log(`‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ: ${successCount}`);
  console.log(`‚ùå –û—à–∏–±–æ–∫: ${errorCount}`);
  
  return { successCount, errorCount };
}

async function checkConnection() {
  try {
    console.log('üîå –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...');
    
    const { data, error } = await supabase
      .from('books')
      .select('count')
      .limit(1);
    
    if (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:', error.message);
      return false;
    }
    
    console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ');
    return true;
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:', error.message);
    return false;
  }
}

async function getBooksCount() {
  try {
    const { count, error } = await supabase
      .from('books')
      .select('*', { count: 'exact', head: true });
    
    if (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å—á–µ—Ç–µ –∫–Ω–∏–≥:', error.message);
      return 0;
    }
    
    return count || 0;
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Å—á–µ—Ç–µ –∫–Ω–∏–≥:', error.message);
    return 0;
  }
}

async function main() {
  console.log('üìö –°–∫—Ä–∏–ø—Ç –≤—Å—Ç–∞–≤–∫–∏ –∫–Ω–∏–≥ –≤ Stefa.Books\n');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
  const isConnected = await checkConnection();
  if (!isConnected) {
    process.exit(1);
  }
  
  // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥
  const initialCount = await getBooksCount();
  console.log(`üìö –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥: ${initialCount}\n`);
  
  // –í—Å—Ç–∞–≤–ª—è–µ–º –∫–Ω–∏–≥–∏
  const result = await insertBooks();
  
  // –ü–æ–ª—É—á–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥
  const finalCount = await getBooksCount();
  const addedBooks = finalCount - initialCount;
  
  console.log('\nüéâ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:');
  console.log(`üìö –ö–Ω–∏–≥ –±—ã–ª–æ: ${initialCount}`);
  console.log(`üìö –ö–Ω–∏–≥ —Å—Ç–∞–ª–æ: ${finalCount}`);
  console.log(`‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ: ${addedBooks}`);
  console.log(`‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: ${result.successCount}`);
  console.log(`‚ùå –û—à–∏–±–æ–∫: ${result.errorCount}`);
  
  if (result.errorCount === 0) {
    console.log('\nüéä –í—Å–µ –∫–Ω–∏–≥–∏ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã!');
  } else {
    console.log('\n‚ö†Ô∏è  –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–Ω–∏–≥–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ.');
  }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç
if (require.main === module) {
  main().catch(error => {
    console.error('üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', error);
    process.exit(1);
  });
}

module.exports = { insertBooks, checkConnection, getBooksCount };
