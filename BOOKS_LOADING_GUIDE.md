# üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –∫–Ω–∏–≥ –∏–∑ Google Sheets

## üéØ –û–±–∑–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–Ω–∏–≥ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Stefa.Books:

1. **`smart_books_loader.sql`** - –£–º–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
2. **`quick_books_loader.sql`** - –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ –æ–¥–Ω–æ–π –∫–Ω–∏–≥–µ
3. **`bulk_books_loader.sql`** - –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–Ω–∏–≥
4. **`google_sheets_to_db.js`** - Node.js —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor
\i quick_books_loader.sql
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor
\i bulk_books_loader.sql
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
- `title` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏
- `author` - –ê–≤—Ç–æ—Ä
- `isbn` - ISBN –∫–æ–¥ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è:
- `description` - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `short_description` - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- `cover_url` - URL –æ–±–ª–æ–∂–∫–∏ –≤ Cloudinary
- `category` - –ö–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ü—Ä–∏–≥–æ–¥–∏, –º–æ–ª–æ–¥—à–∏–π –≤—ñ–∫")
- `age_range` - –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: "8-12 —Ä–æ–∫—ñ–≤")
- `pages` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- `language` - –Ø–∑—ã–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 'uk')
- `publisher` - –ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ
- `publication_year` - –ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è
- `available` - –î–æ—Å—Ç—É–ø–Ω–∞ –ª–∏ –∫–Ω–∏–≥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true)
- `qty_total` - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
- `qty_available` - –î–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `price_daily` - –¶–µ–Ω–∞ –∑–∞ –¥–µ–Ω—å
- `price_weekly` - –¶–µ–Ω–∞ –∑–∞ –Ω–µ–¥–µ–ª—é
- `price_monthly` - –¶–µ–Ω–∞ –∑–∞ –º–µ—Å—è—Ü
- `price_uah` - –¶–µ–Ω–∞ –∑–∞–∫—É–ø–∫–∏ –≤ –≥—Ä–∏–≤–Ω–∞—Ö
- `location` - –ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- `tags` - –¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
- `badges` - –ó–Ω–∞—á–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:

| –ù–∞–∑–≤–∞ | –ê–≤—Ç–æ—Ä | ISBN | –û–ø–∏—Å | –û–±–∫–ª–∞–¥–∏–Ω–∫–∞ | –ö–∞—Ç–µ–≥–æ—Ä—ñ—è | –í—ñ–∫–æ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è | –°—Ç–æ—Ä—ñ–Ω–∫–∏ | –ú–æ–≤–∞ | –í–∏–¥–∞–≤–µ—Ü—å | –†—ñ–∫ –≤–∏–¥–∞–Ω–Ω—è | –î–æ—Å—Ç—É–ø–Ω–∞ | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–≥–∞–ª—å–Ω–∞ | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ | –¶—ñ–Ω–∞ –∑–∞ –¥–µ–Ω—å | –¶—ñ–Ω–∞ –∑–∞ —Ç–∏–∂–¥–µ–Ω—å | –¶—ñ–Ω–∞ –∑–∞ –º—ñ—Å—è—Ü—å | –¶—ñ–Ω–∞ –∑–∞–∫—É–ø–∫–∏ | –ú—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è | –¢–µ–≥–∏ | –ó–Ω–∞—á–∫–∏ |
|-------|-------|------|------|------------|-----------|------------------|----------|------|----------|-------------|----------|-------------------|-------------------|--------------|----------------|---------------|--------------|-----------------|------|--------|
| –ü—Ä–∏–≥–æ–¥–∏ –¢–æ–º–∞ –°–æ–π—î—Ä–∞ | –ú–∞—Ä–∫ –¢–≤–µ–Ω | 978-617-12-3456-7 | –ö–ª–∞—Å–∏—á–Ω–∏–π —Ä–æ–º–∞–Ω... | https://... | –ü—Ä–∏–≥–æ–¥–∏, –º–æ–ª–æ–¥—à–∏–π –≤—ñ–∫ | 8-12 —Ä–æ–∫—ñ–≤ | 320 | uk | –ê-–ë–ê-–ë–ê-–ì–ê-–õ–ê-–ú–ê-–ì–ê | 2020 | —Ç–∞–∫ | 3 | 3 | 15.00 | 80.00 | 200.00 | 150.00 | –ü–æ–ª–∏—Ü—è –ê-1 | –ø—Ä–∏–≥–æ–¥–∏, –∫–ª–∞—Å–∏–∫–∞ | –ø–æ–ø—É–ª—è—Ä–Ω–∞, –Ω–æ–≤–∞ |

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Sheets
2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" ‚Üí "–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ –≤—Å–µ—Ö, —É –∫–æ–≥–æ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞"
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –∏–∑ URL

## ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ Node.js

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
npm install googleapis @supabase/supabase-js
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# Google Sheets
export GOOGLE_SHEET_ID="your_spreadsheet_id"
export GOOGLE_SERVICE_ACCOUNT_KEY_FILE="./google-service-account.json"

# Supabase
export NEXT_PUBLIC_SUPABASE_URL="your_supabase_url"
export SUPABASE_SERVICE_ROLE_KEY="your_service_role_key"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏
export DRY_RUN="false"  # true –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ Service Account:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ Google Sheets API
4. –°–æ–∑–¥–∞–π—Ç–µ Service Account
5. –°–∫–∞—á–∞–π—Ç–µ JSON –∫–ª—é—á
6. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å email Service Account

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
node google_sheets_to_db.js
```

## üìã –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–Ω–∏–≥

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º:

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
- **–ü—Ä–∏–≥–æ–¥–∏** - –ø—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–∏–µ –∫–Ω–∏–≥–∏
- **–ö–∞–∑–∫–∏** - —Å–∫–∞–∑–∫–∏ –∏ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞
- **–§–µ–Ω—Ç–µ–∑—ñ** - —Ñ—ç–Ω—Ç–µ–∑–∏
- **–î–µ—Ç–µ–∫—Ç–∏–≤** - –¥–µ—Ç–µ–∫—Ç–∏–≤—ã
- **–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è —ñ —Å–∞–º–æ—Ä–æ–∑–≤–∏—Ç–æ–∫** - –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è
- **–ü—ñ–∑–Ω–∞–≤–∞–ª—å–Ω—ñ** - –ø–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω—ã–µ
- **–°—É—á–∞—Å–Ω–∞ –ø—Ä–æ–∑–∞** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–∑–∞

### –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
- **–î–æ—à–∫—ñ–ª—å–Ω–∏–π –≤—ñ–∫** - 3-6 –ª–µ—Ç
- **–ú–æ–ª–æ–¥—à–∏–π –≤—ñ–∫** - 6-12 –ª–µ—Ç
- **–°–µ—Ä–µ–¥–Ω—ñ–π –≤—ñ–∫** - 12-16 –ª–µ—Ç
- **–ü—ñ–¥–ª—ñ—Ç–∫–æ–≤–∏–π –≤—ñ–∫** - 14+ –ª–µ—Ç

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT 
    COUNT(*) as total_books,
    COUNT(CASE WHEN available = true THEN 1 END) as available_books,
    COUNT(DISTINCT category_id) as categories_with_books,
    COUNT(DISTINCT author) as unique_authors
FROM public.books;

-- –ö–Ω–∏–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
SELECT 
    c.name as category,
    COUNT(b.id) as books_count
FROM public.categories c
LEFT JOIN public.books b ON c.id = b.category_id
WHERE c.parent_id IS NOT NULL
GROUP BY c.name
ORDER BY books_count DESC;

-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏
SELECT 
    title,
    author,
    code,
    available,
    created_at
FROM public.books
ORDER BY created_at DESC
LIMIT 10;
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –ö–Ω–∏–≥–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ ISBN –∏ –∫–æ–¥—É
2. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
3. **–ö–æ–¥—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ `SB-YYYY-NNNN`
4. **–û–±–ª–æ–∂–∫–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Cloudinary –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
5. **–¶–µ–Ω—ã**: –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –≤ –≥—Ä–∏–≤–Ω–∞—Ö (UAH)

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "column age_category_id does not exist"
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `quick_books_loader.sql` –∏–ª–∏ `bulk_books_loader.sql`
- –≠—Ç–∏ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏

### –û—à–∏–±–∫–∞ "duplicate key value violates unique constraint"
- –ö–Ω–∏–≥–∞ —Å —Ç–∞–∫–∏–º ISBN –∏–ª–∏ –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏

### –û—à–∏–±–∫–∞ "function find_category_by_parts does not exist"
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ `smart_books_loader.sql`

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Supabase
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (`DRY_RUN=true`)

---

**–£–¥–∞—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–Ω–∏–≥! üìö‚ú®**
