# üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î –∏ Cloudinary

## ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

### 1. **Supabase –ø–∞–∫–µ—Ç**
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –ø–∞–∫–µ—Ç `@supabase/supabase-js`
- ‚úÖ –ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### 2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Supabase** 
- ‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `supabase/security_fixes.sql` —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:
  - RLS –≤–∫–ª—é—á–µ–Ω –¥–ª—è `book_authors` —Å –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ —á—Ç–µ–Ω–∏—è
  - –§—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω—ã —Å `SET search_path = public` (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ RLS –¥–ª—è `search_queries`  
  - –°–æ–∑–¥–∞–Ω—ã —Ä–æ–ª–∏ `stefa_books_app` –∏ `stefa_books_admin` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

### 3. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º—ã –ë–î**
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `src/lib/database.types.ts` –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É –∏–∑ `setup_database.sql`:
  - `price_uah` –≤–º–µ—Å—Ç–æ `price_daily/weekly/monthly`
  - `qty_total`, `qty_available` –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü (books, authors, categories, users, rentals, payments, search_queries)
  - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏: `search_books`, `update_book_availability`, `get_search_suggestions`

### 4. **Cloudinary –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ `src/app/api/admin/upload/cover/route.ts`
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `.env.local.example`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—é—Ç

## üìã **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

### –í Supabase Dashboard:
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ `supabase/security_fixes.sql`
2. –≠—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç –≤—Å–µ Security Advisor warnings
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã

### –í –ø—Ä–æ–µ–∫—Ç–µ:
```bash
# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∞
# –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

## üö® **–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã TypeScript:**

–ï—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ç–∏–ø–æ–≤ –≤ –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –º–µ–∂–¥—É:
- `src/lib/types.ts` (—Å—Ç–∞—Ä—ã–π —Ç–∏–ø Book —Å `cover`, `price: {old, current}`)
- `src/lib/database.types.ts` (–Ω–æ–≤—ã–π —Ç–∏–ø —Å `cover_url`, `price_uah`)

**–†–µ—à–µ–Ω–∏–µ:** –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ –∏–∑ –ë–î.

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç 
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–ª–æ–∂–µ–∫ —á–µ—Ä–µ–∑ Cloudinary
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase
- ‚ùå –ü–æ–∏—Å–∫ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ç–∏–ø–æ–≤

## üìÑ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å `security_fixes.sql` –≤ Supabase
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ç–∏–ø–æ–≤ –≤ –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ  
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å